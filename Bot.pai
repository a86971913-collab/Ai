import telebot
import google.generativeai as genai

# === –¢–í–û–ò –ö–õ–Æ–ß–ò ===
TELEGRAM_TOKEN = '8500878184:AAFh1beEL5_TRfoWC7hSNbGBfk1aNFSVtPs'
GEMINI_KEY = 'AIzaSyDsPEUIYbptBFT2zFoZ7n-elYOl_xB5hSY'
ADMIN_ID = 8511239888
# =================

genai.configure(api_key=GEMINI_KEY)
model = genai.GenerativeModel('gemini-pro')
bot = telebot.TeleBot(TELEGRAM_TOKEN)

@bot.message_handler(commands=['start'])
def start(message):
    if message.chat.id == ADMIN_ID:
        bot.send_message(ADMIN_ID, "–ü—Ä–∏–≤–µ—Ç, –ë–æ—Å—Å! –Ø –Ω–∞ —Å–≤—è–∑–∏. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥—É—Ç –ø–∞–¥–∞—Ç—å —Å—é–¥–∞.")
    else:
        bot.send_message(message.chat.id, "–ü—Ä–∏–≤–µ—Ç! –Ø –ò–ò-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–µ—Ä–≤–µ—Ä–∞. –ó–∞–¥–∞–π —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å, –∏ —è –æ—Ç–≤–µ—á—É.")

@bot.message_handler(func=lambda message: True)
def handle_all_messages(message):
    try:
        if message.chat.id == ADMIN_ID:
            # –¢—É—Ç –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ç–µ–±—è: –µ—Å–ª–∏ —Ç—ã –ø–µ—Ä–µ—Å—ã–ª–∞–µ—à—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –±–æ—Ç—É –∏ –ø–∏—à–µ—à—å –æ—Ç–≤–µ—Ç
            if message.reply_to_message:
                # –ï—Å–ª–∏ —Ç—ã –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ ‚Äî –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –µ–º—É
                original_user_id = message.reply_to_message.forward_from.id
                bot.send_message(original_user_id, message.text)
                bot.send_message(ADMIN_ID, "–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏–≥—Ä–æ–∫—É!")
            else:
                bot.send_message(ADMIN_ID, "–ë–æ—Å—Å, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –æ—Ç–≤–µ—Ç–∏—Ç—å –∏–≥—Ä–æ–∫—É ‚Äî –Ω–∞–∂–º–∏ 'Reply' –Ω–∞ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–∏.")
        
        else:
            # –õ–æ–≥–∏–∫–∞ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤ (–ò–ò –æ—Ç–≤–µ—á–∞–µ—Ç + –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Ç–µ–±–µ)
            response = model.generate_content(f"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –≤ –ú–∞–π–Ω–∫—Ä–∞—Ñ—Ç–µ. –û—Ç–≤–µ—Ç—å –∏–≥—Ä–æ–∫—É: {message.text}")
            bot.reply_to(message, response.text)
            
            # –ü–µ—Ä–µ—Å—ã–ª–∞–µ–º —Ç–µ–±–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞, —á—Ç–æ–±—ã —Ç—ã –±—ã–ª –≤ –∫—É—Ä—Å–µ
            bot.forward_message(ADMIN_ID, message.chat.id, message.message_id)
            bot.send_message(ADMIN_ID, f"üëÜ –ò–≥—Ä–æ–∫ @{message.from_user.username} —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —ç—Ç–æ. –Ø –æ—Ç–≤–µ—Ç–∏–ª –µ–º—É —Å–∞–º, –Ω–æ —Ç—ã –º–æ–∂–µ—à—å –≤–º–µ—à–∞—Ç—å—Å—è.")

    except Exception as e:
        print(f"–û—à–∏–±–∫–∞: {e}")

bot.polling(none_stop=True)
